---
import { PROBLEM_ITEMS } from "@config";

const items = PROBLEM_ITEMS.ar;
---

<section id="problem" class="py-16">
  <div class="text-center mb-20">
    <p class="text-sm font-semibold uppercase tracking-widest text-amber-400 mb-4">المشكلة</p>
    <h2
      id="problem-title"
      class="text-3xl md:text-5xl font-bold font-serif gradient-text-primary mb-6"
    >
      صار معك كذا قبل؟
    </h2>
    <p id="problem-subtitle" class="text-lg text-neutral max-w-xl mx-auto leading-relaxed">
      عندك فكرة تطبيق بس كل ما تسأل مطوّر يقولك شهور وأرقام خيالية
    </p>
  </div>

  <div class="grid grid-cols-1 sm:grid-cols-2 gap-8" id="problem-grid">
    {
      items.map(({ icon, title, description }, index) => (
        <div
          class="problem-card group text-center rounded-3xl border border-amber-500/10 bg-gradient-to-b from-amber-500/5 to-transparent p-10 transition-all duration-500 hover:border-amber-500/25 hover:from-amber-500/10 hover:shadow-xl hover:shadow-amber-500/5 hover:-translate-y-1"
          data-problem-index={index}
        >
          <div class="problem-icon inline-flex items-center justify-center w-16 h-16 rounded-2xl bg-amber-500/10 border border-amber-500/20 mb-6 group-hover:scale-110 transition-transform duration-300">
            {icon === "clock" && (
              <svg class="w-8 h-8 text-amber-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
            )}
            {icon === "money" && (
              <svg class="w-8 h-8 text-amber-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 6v12m-3-2.818l.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
            )}
            {icon === "loop" && (
              <svg class="w-8 h-8 text-amber-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182M20.016 4.66v4.993" />
              </svg>
            )}
            {icon === "wrench" && (
              <svg class="w-8 h-8 text-amber-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M11.42 15.17l-5.384 5.383a1.5 1.5 0 01-2.12-2.122l5.382-5.382m0 0l-1.586-1.586a2.25 2.25 0 010-3.182l3.536-3.536a2.25 2.25 0 013.182 0l1.586 1.586m-8.718 7.218l8.718-7.218" />
              </svg>
            )}
          </div>
          <h3 class="problem-title text-xl font-bold text-white mb-3">{title}</h3>
          <p class="problem-description text-neutral text-sm leading-relaxed max-w-xs mx-auto">{description}</p>
        </div>
      ))
    }
  </div>
</section>

<style>
  .problem-card {
    text-align: center !important;
  }
  [dir="rtl"] .problem-card {
    text-align: center !important;
  }
  [dir="rtl"] .problem-card * {
    text-align: center !important;
  }
</style>

<script>
  import { languageStore } from "@app/language-store";
  import { PROBLEM_ITEMS } from "@config";

  const updateProblem = () => {
    const ui = languageStore.content.ui;
    const lang = languageStore.language as "en" | "ar";
    const items = PROBLEM_ITEMS[lang];

    const titleEl = document.getElementById("problem-title");
    const subtitleEl = document.getElementById("problem-subtitle");

    if (titleEl) titleEl.textContent = ui.problemTitle || "Sound Familiar?";
    if (subtitleEl) subtitleEl.textContent = ui.problemSubtitle || "Most app ideas die before they see the light";

    const cards = document.querySelectorAll("[data-problem-index]");
    cards.forEach((card, index) => {
      const item = items[index];
      if (!item) return;
      const titleEl = card.querySelector(".problem-title");
      const descEl = card.querySelector(".problem-description");
      if (titleEl) titleEl.textContent = item.title;
      if (descEl) descEl.textContent = item.description;
    });
  };

  window.addEventListener("language-change", updateProblem);
  updateProblem();
</script>
